

#### Три типа Задач ЗУП

релиз ЗУП 3.1.23.20


##### Показатели расчета ЗП

- Справочник
    - Ключевые реквизиты
        - Назначение Показателя  (Сотрудник/Подразделение/Организация)
        - Способ Применения Значений  (Постоянное/Разовое)
        - Способ Ввода Значений (Единовременно/Накапливается/При расчете)
- Хранение Значений Показателей:
    - РС
    - РН (для накапливаемых) 


###### Постановка

- Автоматизация расчета  удержания
    - Существует лимит (сумма) на связь привязанный к номеру, оплачиваемый Организацией
    - Номера не имеющие лимита но, привязанные к Сотруднику(родственник) - сумма за услуги связи удерживается из з/п
    - **1-я часть Задания:**
        - Сумма сверх лимита удерживается из з/п 
    - **2-я часть Задания:**
        - Сумма сверх лимита является суммой натурального  дохода из з/п 
    

###### Реализация

- В пользовательском режиме
    - Созданием Документа (шаблон ввода Исходных данных)

- Изменение функциональности конфигурации:
    - Конфигуратор
        - Создаваемые Объекты
            - Подсистема(в п/с `Курс ЗУП`):
                - `ОплатаУслугСвязи` 
            - Справочник (Хранение Номеров): 
                -`ТелефонныеНомера` 
            - РС (Хранение информации в связке `Номер + Сотрудник`): 
                - `ТелефоныСотрудников`
                    - Периодичность: Непериодический → *разовый показатель*
                    - Режим записи: Независимый  
                    - Измерения:
                        - Сотрудники → СправочникСсылка.Сотрудники
                        - ТелефонныйНомер → СправочникСсылка.ТелефонныеНомера
                    - Реквизит
                        - Телефон Родственника → Булево 
            - РС (Хранение информации о лимитах на связь в связке `Должность + Сумма`): 
                - `ЛимитыОплатыМобильнойСвязи`:
                    - Измерение:
                       - Должность → СправочникСсылка.Должности
                    - Ресурс:
                        - ЛИмит → Число  10/0
            - Документ (`СчетНаОплатуУслугСвязи`):
                - Реквизиты:
                    - Шапка:   
                        - Организация → СправочникСсылка.Организации
                        - Дата
                        - Показатель → СправочникСсылка.ПоказателиРасчетаЗарплаты
                    - ТЧ (`Расходы`):
                        - ТелефонныйНомер → СправочникСсылка.ТелефонныеНомера
                        - Сумма  → Число  15/2
                - Движения :
                    - РС → Значения Разовых Показателей  Расчета ЗП Сотрудников
    - Отладка :
        - [Получаем](https://github.com/alex-dev-2020/HRM_3_1_23/commit/381c9b54f3932dee3abfdb696d6e64a9599a9362) расширенный список Кадровых Данных (колонки "Должность, ГрафикРаботы, ВидЗанятости" )
            - *отладчик`МенеджерВременныхТаблиц.Таблицы[0].ПолучитьДанные().Выгрузить()`*
        - оставляем расширенный список (необходима только "Должность")
    - Получение Таблицы с Разовыми Показателями
        - Запрос:
            - Таблицы & Поля
                - 1-й Запрос Пакета:
                    - ВТКадровыеДанныеСотрудников (Общ. Модуль `КадровыйУчет`) → Сотрудник
                    - ЛимитыОплатыМобильнойСвязи (РС)  → Лимит
                        - Слева РС
                    - → `ВТ_Лимиты `
                - 2-й  Запрос Пакета
                    - СчетНаОплатуУслугСвязиРасходы (Документ)  → Месяц (`ПериодДействия`) ← *привести к началу периода*
                    - ТелефоныСотрудников (РС) → `Сотрудник`
                    - СчетНаОплатуУслугСвязиРасходы (Документ) → `Показатель`
                    - →  `Значение`
                        - если телефон родственника → Сумма целиком (*Сотрудник  платит за родственника полностью*)
                        - если телефон сотрудника → проверяем превышение лимита
                            - ? Лимит превышен : →  `Сумма - Лимит`  (*определяем Определяем Сумму удержания*) 
            - Условия :
                - Только если превышен лимит (код из Поля `Значение`)
                - Ссылка на Документ 
    - При отладке внимательно с  Датами
        - Документы должны относиться к **ОДНОМУ** Периоду !!!
    
    - 1-я часть Задания реализована:
        - [Модуль Объекта](https://github.com/alex-dev-2020/HRM_3_1_23/commit/28aa8b3521c0045417da4cc7f0727b1df96b5067) Документа `СчетНаОплатуУслугСвязи`
      - Создаем & проводим Документ `СчетНаОплатуУслугСвязи`
      - Создаем Начисление Зарплаты & взносов **в соответствующем**  периоде
        -  см. Закладку `Удержания`    

               